Руководство и задания к 1-ой практике. На практике поработаем с запросами и потренируемся с HTML версткой.

### 1. Работа с запросами к сервису погоды

Будем рассматривать 2 подхода к использованию ключа API сервиса погоды.

#### 1.1 Использование ключа в параметрах запроса

Получение ключа для API будем производить через сервис https://www.weatherapi.com/ 

Регистрируемся, если не зарегистрированы https://www.weatherapi.com/signup.aspx и подтверждаем почту

После регистрации автоматически появится версия Pro+ на 14 дней, если планируете продолжить пользоваться, то можно перейти
на бесплатную базовую версию.

Для создания запросов к сервису будет необходим API ключ, который находится во вкладке `Dashboard`

![1.png](pic_for_task/1.png)

Примеры запросов можно посмотреть в документации https://www.weatherapi.com/docs/

##### *Создание запросов через адресную строку браузера*

Чаще всего доступ к API идёт через параметры запроса, то возвращаемую информацию можно посмотреть через браузер

Вот пример запроса к данному сервису 

`https://api.weatherapi.com/v1/current.json?key=<YOUR_API_KEY>&q=London`

здесь:
* `key` - ваш ключ доступа
* `q` - локация, где необходимо получить данные. Локацию можно задавать как именем города, так и координатами широта, 
долгота (`q=<lat>,<lon>`), как пример `q=51.52,-0.11`

##### Самостоятельно

Через браузер получите данные о погоде с использованием вашего ключа и желаемой области

Ниже приведен пример запроса для получения данных о погоде для Санкт-Петербурга

`https://api.weatherapi.com/v1/current.json?key=b4588e45fcc14bdb89d63200232109&q=59.93,30.31`

![2.png](pic_for_task/2.png)

##### *Создание запросов через команду curl*

Также можно использовать команду `curl` в консоли, чтобы получить информацию от сайта. Для корректной работы необходимо
адрес обернуть в кавычки.

```cmd
curl "https://api.weatherapi.com/v1/current.json?key=b4588e45fcc14bdb89d63200232109&q=59.93,30.31"
```

![3.png](pic_for_task/3.png)

##### *Создание запросов через модуль requests*

У Python есть сторонний модуль requests для работы с запросами. Сделаем запрос с использованием Python console PyCharm

```python
import requests

key = "b4588e45fcc14bdb89d63200232109"  # ваш ключ к API
lat = "59.93"  # широта в градусах
lon = "30.31"  # долгота в градусах

url = f"https://api.weatherapi.com/v1/current.json?key={key}&q={lat},{lon}"
response = requests.get(url)  # отправление GET запроса и получение ответа от сервера
print(response.json())  # получение JSON из ответа
```

![4.png](pic_for_task/4.png)

#### 1.2 Использование ключа в заголовке запроса

В этот раз воспользуемся сервисом Яндекса

Необходимо зайти под аккаунтом яндекса и перейти в кабинет разработчика https://developer.tech.yandex.ru/, 
где подключим `API Яндекс.Погоды`

![5.png](pic_for_task/5.png)

![6.png](pic_for_task/6.png)

Далее заполняем форму, бесплатного тарифа в 50 запросов в день будет достаточно

![7.png](pic_for_task/7.png)

Переходим в кабинет разработчика и используем предложенный ключ API

![8.png](pic_for_task/8.png)

![9.png](pic_for_task/9.png)

По умолчанию тариф будет стоять Тестовый. Если есть необходимость его можно понизить до «Погода на вашем сайте» у кнопки
Тарифы

Как использовать API описано в https://yandex.ru/dev/weather/doc/dg/concepts/forecast-info.html

##### *Создание запросов через адресную строку браузера*

Обратимся к API через адресную строку

`https://api.weather.yandex.ru/v2/forecast?lat=59.93&lon=30.31`

И получим, что нет доступа, так как ключ к API необходимо передавать через заголовок, а через адресную строку это 
передать не выйдет

![10.png](pic_for_task/10.png)


##### *Создание запросов через команду curl*
 
У curl есть параметр `-H` отвечающий за формирование заголовка в запросе. У сервиса яндекс погоды есть требование как 
должен называться заголовок в котором будет передаваться ключ в общем виде это `X-Yandex-API-Key: <значение ключа>`

Пример запроса

`curl -H "X-Yandex-API-Key: 54d73608-c8dd-4c98-b18f-d9a5056525ab" "https://api.weather.yandex.ru/v2/forecast?lat=59.93&lon=30.31"`

![11.png](pic_for_task/11.png)

##### *Создание запросов через модуль requests*

Для работы с заголовками у `requests` есть параметр `headers` в который в виде словаря передаются заголовки и их значения

```python
import requests

key = "54d73608-c8dd-4c98-b18f-d9a5056525ab"  # ключ вашего API
lat = "59.93"  # широта в градусах
lon = "30.31"  # долгота в градусах

url = f"https://api.weather.yandex.ru/v2/forecast?lat={lat}&lon={lon}"
headers={"X-Yandex-API-Key": f"{key}"}

response = requests.get(url, headers=headers)
print(response.json())
```
![12.png](pic_for_task/12.png)


#### 1.3 Самостоятельно 

В корне проекта создайте файл `weather_api.py`. Далее git предложит добавить файл в систему индексации git 
(для отслеживания изменений в данном файле). Добавим этот файл нажав на `Add` 

![13.png](pic_for_task/13.png)

Если по каким-то причинам файл не добавился (название файла горит красным цветом), то можно это сделать вручную, для этого
правой кнопкой мыши щелкните на файле далее `Git` далее `Add`

![14.png](pic_for_task/14.png)

В случае добавления файла в систему индексации, то имя файла будет гореть зелёным

![15.png](pic_for_task/15.png)


В файле `weather_api.py` создайте функцию `current_weather` (пример функции есть ниже) с входными переменными широты и долготы. 
Функция должна возвращать словарь(рядом с описанием написаны ключи по которым можно получить данные из возвращаемого JSON
соответствующего API): 

| Ключ  возвращаемого словаря                                           | Получение значения из API Яндекс Погода                                                                                                                            | Получение значения из API weatherapi                                                                                                                                                               |
|-----------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `city` (город)                                                        | `['geo_object']['locality']['name']`                                                                                                                               | `['location']['name']`                                                                                                                                                                             |
| `time` (время когда было обновление информации) <br/>[формат час:мин] | `['fact']['uptime']` - возвращает время в целом значении секунд, для перевода к формату datetime можно воспользоваться методом `fromtimestamp` подробнее в примере | `['current']['last_updated']`                                                                                                                                                                      |
| `temp` (температура) [градус Цельсия]                                 | `['fact']['temp']`                                                                                                                                                 | `['current']['temp_c']`                                                                                                                                                                            |
| `feels_like_temp` (ощущаемая температура) [градус Цельсия]            | `['fact']['feels_like']`                                                                                                                                           | `['current']['feelslike_c']`                                                                                                                                                                       |
| `pressure` (давление) [мм. ртутного столба]                           | `['fact']['pressure_mm']`                                                                                                                                          | `['current']['pressure_mb']` - возвращает давление в ГПа, необходимо перевести в мм. ртутного столба, для этого давление необходимо умножить на 0.75, результат округлить до 1 знака после запятой |
| `humidity` (влажность) [%]                                            | `['fact']['humidity']`                                                                                                                                             | `['current']['humidity']`                                                                                                                                                                          |
| `wind_speed` (скорость ветра) [м/с]                                   | `['fact']['wind_speed']`                                                                                                                                           | `['current']['wind_kph']` -  возвращает скорость в км/ч необходимо перевести в м/с, для этого скорость нужно поделить на 3.6, результат округлить до 1 знака после запятой                         |
| `wind_gust` (порывы ветра) [м/с]                                      | `['fact']['wind_gust']`                                                                                                                                            | `['current']['gust_kph']` - возвращает скорость порывов в км/ч, необходимо перевести в м/с, результат округлить до 1 знака после запятой)                                                          |
| `wind_dir` (направление ветра)                                        | `['fact']['wind_dir']` - возвращает латинское обозначение направления с *маленькой* буквы                                                                          | `['current']['wind_dir']` - возвращает латинское обозначение направления с *большой* буквы                                                                                                         |


Направление ветра привести к читаемому виду на русском языке, ниже таблица перевода

![16.png](pic_for_task/16.png)

Для упрощения приведён словарь

```python
DIRECTION_TRANSFORM = {
    'n': 'северное',
    'nne': 'северо - северо - восточное',
    'ne': 'северо - восточное',
    'ene': 'восточно - северо - восточное',
    'e': 'восточное',
    'ese': 'восточно - юго - восточное',
    'se': 'юго - восточное',
    'sse': 'юго - юго - восточное',
    's': 'южное',
    'ssw': 'юго - юго - западное',
    'sw': 'юго - западное',
    'wsw': 'западно - юго - западное',
    'w': 'западное',
    'wnw': 'западно - северо - западное',
    'nw': 'северо - западное',
    'nnw': 'северо - северо - западное',
    'c': 'штиль',
}
```

Данные погоды взять из одного из предложенных выше API погоды. 

Входные и выходные переменные должны быть аннотированы. Должно быть описание функции.

В блоке `if __name__ == '__main__'` проверить работоспособность функции.

Кто хочет, тот может реализовать две функции на разных API, чтобы посмотреть, как отличаются данные разных сервисов.

Функция `current_weather` будет использована в следующей лабораторной работе.

Пример функции `current_weather` для API Яндекс Погода

```python
import requests
from datetime import datetime

DIRECTION_TRANSFORM = {
    'n': 'северное',
    'nne': 'северо - северо - восточное',
    'ne': 'северо - восточное',
    'ene': 'восточно - северо - восточное',
    'e': 'восточное',
    'ese': 'восточно - юго - восточное',
    'se': 'юго - восточное',
    'sse': 'юго - юго - восточное',
    's': 'южное',
    'ssw': 'юго - юго - западное',
    'sw': 'юго - западное',
    'wsw': 'западно - юго - западное',
    'w': 'западное',
    'wnw': 'западно - северо - западное',
    'nw': 'северо - западное',
    'nnw': 'северо - северо - западное',
    'c': 'штиль',
}

def current_weather(lat, lon):
    """
    Описание функции, входных и выходных переменных
    """
    token = 'Ваш токен'
    url = f"https://api.weather.yandex.ru/v2/forecast?lat={lat}&lon={lon}"
    headers = {"X-Yandex-API-Key": f"{token}"}
    response = requests.get(url, headers=headers)
    data = response.json()

    direction_transform = {
        'nw': 'северо - западное',
        'n': 'северное',
        'ne': 'северо - восточное',
        'e': 'восточное',
        'se': 'юго - восточное',
        's': 'южное',
        'sw': 'юго - западное',
        'w': 'западное',
        'c': 'штиль',
    }

    result = {
        'city': data['geo_object']['locality']['name'],
        'time': datetime.fromtimestamp(data['fact']['uptime']).strftime("%H:%M"),
        'temp': 'реализация',
        'feels_like_temp': 'реализация',
        'pressure': 'реализация',
        'humidity': 'реализация',
        'wind_speed': 'реализация',
        'wind_gust': 'реализация',
        'wind_dir': DIRECTION_TRANSFORM.get(data['fact']['wind_dir']),
    }
    return result


if __name__ == "__main__":
    print(current_weather(59.93, 30.31))
```

![17.png](pic_for_task/17.png)

### 2. Создание коммитов и отправление изменений на github

Создадим коммит наших изменений проекта (реализация `weather_api.py`)

Для этого нажимаем на зеленую галочку вверху справа `PyCharm` или во вкладке `Git` нажимаем `Commit`

![18.png](pic_for_task/18.png)

Далее появится форма, где можно будет посмотреть те изменения, которые вы хотите зафиксировать в системе контроля версий.

Назовите коммит и нажмите `Commit`

![19.png](pic_for_task/19.png)

Название файла `weather_api.py` перестало как-то светиться, значит коммит с этим файлом был сформирован.

![20.png](pic_for_task/20.png)

Процедура создания коммитов необходима для добавления изменений в систему контроля версий, однако, данные изменения есть
на вашей локальной машине, чтобы перенести эти изменения на сервер `github`, то воспользуемся процедурой `Push`.

Для этого нажмём на зелёную стрелку вверху справа `PyCharm` или во вкладке `Git` нажимаем `Push`

![21.png](pic_for_task/21.png)

Откроется окно с информацией от коммитах, что собираетесь передать. Для передачи нажмём на `Push`

![22.png](pic_for_task/22.png)

Теперь ваш коммит есть на `github`, а значит и весь тот код, что написали в `weather_api.py` - теперь есть на `github`

### 3. Работа с HTML файлами и вёрсткой

В данной части практики рассмотрим создание и заполнение HTML5, а так же работу с каскадными стилями CSS. 

В модуле P110 будут рассмотрены основные элементы и атрибуты HTML для понимания HTML файлов.
Наша задача научиться понимать файл HTML, а не уметь его создавать с нуля.

Подробно про HTML с его элементами и атрибутами можно прочитать [здесь](https://html5book.ru/html-html5/)

#### *Работа с HTML в PyCharm*

Создайте HTML файл `example.html` через обозреватель `PyCharm` в вашей корневой папке проекта. Почему через `PyCharm`?
`PyCharm` автоматически подготовит простейшую структуру `HTML` файла.

![img.png](img.png)

Структура документа HTML созданного PyCharm

![img_1.png](img_1.png)

Ниже немного рассказано об элементах `example.html`:

* `<!DOCTYPE html>`: Объявление типа документа и начало HTML5-документа.

* `<html>`: Корневой элемент HTML-документа, который охватывает все содержимое страницы.

* `<head>`: Секция, содержащая метаданные и ссылки на внешние ресурсы, такие как стили, скрипты и мета-теги.

* `<meta>`: Используется для задания метаданных, таких как кодировка символов, описание, ключевые слова и другие.

* `<title>`: Определяет заголовок страницы, который отображается в заголовке веб-браузера или на вкладке.

* `<body>`: Описывает основную часть веб-страницы, которая видна пользователям в их веб-браузерах. 
Внутри элемента `<body>` размещается весь текст, изображения, ссылки, мультимедийный контент, формы и другие элементы, 
которые пользователи видят и с которыми взаимодействуют при посещении веб-страницы.

Как видите есть открывающиеся и закрывающиеся теги, на примере `<body> </body>`, а есть теги которые не нужно закрывать 
как `<meta>`.

Весь контент на сайте, как правило, стараются описать между тегом `<body>`.

`PyCharm` позволяет просмотреть HTML файл как через встроенный обозреватель(preview), так и через обозреватель которые 
есть на вашем компьютере. Данные кнопки отображаются в самом файле в правой части экрана.

![img_2.png](img_2.png)

Попробуйте открыть файл через встроенный и внешний обозреватель и вы увидите белый экран, так как никакой информации для
вас пока нет в файле, то, что написано это базовые конструкции для обозревателя.

По умолчанию обновление отображения содержимого HTML во встроенном браузере идёт 
при сохранении файла HTML, но в настройках это можно изменить если необходимо.

![img_6.png](img_6.png)

#### *Основные элементы HTML5*

Для того чтобы отобразить такой-то текст, тег не нужен, можно просто в любом месте написать что угодно между открытым 
и закрытым тегом `<body>`

Для примера напишите 'Политех' и теперь у нас уже не пустой лист.

![img_3.png](img_3.png)

Но форматирование текста выглядит не так как нам привычно. Допустим переход на новую строку и текст с большими пробелами
будет отображаться не так как мы написали.

![img_4.png](img_4.png)

В этом и кроется краеугольный камень, всё форматирование идёт через теги, чтобы можно было убрать лишние пробелы и более
ёмко передавать данные по сети. Лишний пробел, лишняя и ненужная информация для компьютера, хотя человеку и приятнее 
читать с разделителями, чем без. 

Поэтому лишние пробелы и табуляция не будут влиять на отображении в браузере, но сделают вашу верстку более читаемой.

Элементы HTML можно использовать внутри друг друга, как бы обрамляя собой другие теги, данный подход делает вашу верстку
более гибкой.

Рассмотрение элементов и атрибутов приведено в файле `html_css.md`, почитайте его.


#### *Задание*

Сделаем небольшую верстку

